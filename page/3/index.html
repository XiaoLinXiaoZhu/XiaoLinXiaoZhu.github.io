<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">






  

<script class="next-config" data-name="main" type="application/json">{"hostname":"xiaolinxiaozhu.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script>

    <meta name="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
<meta property="og:type" content="website">
<meta property="og:title" content="XLXZ's Blog">
<meta property="og:url" content="https://xiaolinxiaozhu.github.io/page/3/index.html">
<meta property="og:site_name" content="XLXZ's Blog">
<meta property="og:description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="XLXZ">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://xiaolinxiaozhu.github.io/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>XLXZ's Blog</title>
  








  <noscript>
    
  </noscript>
<script>function loadCss(l){var d=document,h=d.head,s=d.createElement('link');s.rel='stylesheet';s.href=l;!function e(f){if (d.body)return f();setTimeout(function(){e(f)})}(function(){h.appendChild(s);});}loadCss('/style.css');loadCss('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css');loadCss('https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css');</script><noscript><link rel="stylesheet" href="/style.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css"></noscript></head>

<body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">
      <img class="custom-logo-image" src="/uploads/custom-logo.png" alt="XLXZ's Blog">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">XLXZ's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-sponsor"><a href="/sponsor/" rel="section"><i class="fa fa-heart fa-fw"></i>sponsor</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">76</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">324</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XLXZ" src="/images/apple-touch-icon-next.png">
  <p class="site-author-name" itemprop="name">XLXZ</p>
  <div class="site-description" itemprop="description">����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">324</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">76</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/xiaolinxiaozhu" title="GitHub → https://github.com/xiaolinxiaozhu" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="Gmail:helloxlxz233@gmail.com" title="E-Mail → Gmail:helloxlxz233@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/24/%E5%85%83%E7%B4%A0%E5%90%8C%E5%85%B8%EF%BC%9A%E7%A1%AE%E5%AE%9E%E4%B8%8D%E5%AE%8C%E5%85%A8%E7%A7%91%E5%AD%A6%E7%9A%84%E9%AD%94%E5%AF%BC%E4%B9%A6%20%E6%89%B9%E6%B3%A8/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/24/%E5%85%83%E7%B4%A0%E5%90%8C%E5%85%B8%EF%BC%9A%E7%A1%AE%E5%AE%9E%E4%B8%8D%E5%AE%8C%E5%85%A8%E7%A7%91%E5%AD%A6%E7%9A%84%E9%AD%94%E5%AF%BC%E4%B9%A6%20%E6%89%B9%E6%B3%A8/" class="post-title-link" itemprop="url">元素同典：确实不完全科学的魔导书 批注</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-24 20:12:00 / 修改时间：20:52:00" itemprop="dateCreated datePublished" datetime="2025-03-24T20:12:00+08:00">2025-03-24</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>annotation-target:: [[元素同典：确实不完全科学的魔导书.pdf]]</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/24/%E5%85%83%E7%B4%A0%E5%90%8C%E5%85%B8%EF%BC%9A%E7%A1%AE%E5%AE%9E%E4%B8%8D%E5%AE%8C%E5%85%A8%E7%A7%91%E5%AD%A6%E7%9A%84%E9%AD%94%E5%AF%BC%E4%B9%A6%20%E6%89%B9%E6%B3%A8/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/24/Obsidian%20Annotator%20%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E5%A4%87%E5%BF%98%E5%BD%95/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/24/Obsidian%20Annotator%20%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E5%A4%87%E5%BF%98%E5%BD%95/" class="post-title-link" itemprop="url">Obsidian Annotator 插件使用备忘录</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-24 18:18:00 / 修改时间：20:15:10" itemprop="dateCreated datePublished" datetime="2025-03-24T18:18:00+08:00">2025-03-24</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/hexo/" rel="contents" data-pjax-state=""># hexo</a>
<br></p>
<h1 id="obsidian-annotator">Obsidian Annotator</h1>
<p>黑曜石注释器</p>
<p><a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator">项目github</a></p>
<p>这是 Obsidian （<a target="_blank" rel="noopener" href="https://obsidian.md">https://obsidian.md</a>）
的插件。它允许您打开和注释 PDF 和 EPUB 文件。</p>
<p>该插件基于 <a target="_blank" rel="noopener" href="https://web.hypothes.is/">https://web.hypothes.is/</a>，但经过修改后将注释存储在本地
markdown 文件中，而不是存储在 Internet 上。</p>
<h2 id="demonstration">Demonstration</h2>
<p>示范</p>
<p><img src="/2024/03/01/3.Source/131702952-1aa76baa-a279-474c-978d-cec95a683485.gif"></p>
<p><strong>警告！</strong> 在上面的 gif 中，我使用
<strong>Dataview</strong> 语法来指定 annotation-target。如果你没有安装
dataview 插件，则必须在 <strong>frontmatter</strong> 中编写
annotation-target，如下所示：</p>
<figure class="highlight md"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">annotation-target: https://arxiv.org/pdf/2104.13478.pdf</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="getting-started">Getting Started</h2>
<p>开始</p>
<p>将属性 <code>annotation-target</code> 添加到黑曜石便笺的 frontmatter
中，其值对应于 EPUB/PDF 文件的位置。该位置可以是 Vault 中的文件（如
<code>Pdf/mypdf.pdf</code>），也可以是联机文件（如
<code>https://arxiv.org/pdf/2104.13478.pdf</code> ）</p>
<p>然后，您可以在打开的注释窗格中，选择 “more
options”（右上角的三个点），并且应该有一个新选项 “annotate” 可用。</p>
<p>该插件会自动尝试根据文件路径确定文件是 <code>epub</code> 还是
<code>pdf</code>，但如果这不起作用，您还可以添加属性
<code>annotation-target-type</code> 并手动指定它是 <code>epub</code>
还是 <code>pdf</code>。</p>
<p>如果您安装了 <a target="_blank" rel="noopener" href="https://github.com/blacksmithgu/obsidian-dataview">dataview</a>，则还可以使用
dataview 属性指定注释目标。在这种情况下，可以使用 obsidian
样式的链接来代替纯文本路径。</p>
<blockquote>
<p>WARNING! Don't rename an original pdf or epub file! The plugin is
going to lose the connection between annotations and file in that
case.<br>
警告！不要重命名原始 PDF 或 epub 文件！在这种情况下，插件将失去
annotation 和 file 之间的连接。</p>
</blockquote>
<h3 id="annotating">Annotating</h3>
<p>注释 Annotation is self-explanatory. Select text with your mouse to
get started.<br>
注释是不言自明的。用鼠标选择文本以开始使用。</p>
<p>In the future, it would be nice to add colored highlights and
image/region highlights. These features will have to be added to
hypothes.is first, however. See these relevant issues: <a target="_blank" rel="noopener" href="https://github.com/hypothesis/product-backlog/issues/198">hypothesis/product-backlog#198</a>,
<a target="_blank" rel="noopener" href="https://github.com/hypothesis/product-backlog/issues/669">hypothesis/product-backlog#669</a><br>
将来，添加彩色高光和图像/区域高光会很好。但是，必须先将这些功能添加到
hypothes.is 中。请参阅以下相关问题： <a target="_blank" rel="noopener" href="https://github.com/hypothesis/product-backlog/issues/198">hypothesis/product-backlog#198</a>
， <a target="_blank" rel="noopener" href="https://github.com/hypothesis/product-backlog/issues/669">hypothesis/product-backlog#669</a></p>
<h3 id="the-annotations-in-markdown">The annotations in markdown</h3>
<p>markdown 中的注解</p>
<p><a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator#the-annotations-in-markdown"></a></p>
<p>To return to the regular obsidian markdown editing mode, you can
select <code>more options</code> → <code>Open as MD</code>. Each
annotation has an associated quote block with a block reference. Be
careful with modifying these blocks. Minor edits to PREFIX, HIGHLIGHT,
and POSTFIX are typically ok. But if the edits are too major, hypothesis
may no longer be able to identify the corresponding text.<br>
要返回常规的 obsidian markdown 编辑模式，你可以选择
<code>Open as MD</code>→ <code>更多选项</code>
。每个注释都有一个带有块引用的关联 quote 块。修改这些块时要小心。对
PREFIX、HIGHLIGHT 和 POSTFIX
进行次要编辑通常是可以的。但是，如果编辑过于严重，假设可能无法再识别相应的文本。</p>
<p>The COMMENT region can be freely edited. (but ensure that it is still
part of the quote block.)<br>
COMMENT 区域可以自由编辑。（但请确保它仍然是 quote 块的一部分。</p>
<p>The TAGS region should consist of a comma-separated list of obsidian
tags. (like <code>#tag1, #tag2, #tag3</code>)<br>
TAGS 区域应由以逗号分隔的黑曜石标签列表组成。（如
<code>#tag1、#tag2 #tag3</code>）</p>
<h3 id="dark-mode">Dark Mode</h3>
<p>深色模式</p>
<p><a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator#dark-mode"></a></p>
<p>The plugin has built-in dark mode support. To toggle dark mode,
select <code>more options</code> → <code>Toggle Dark Mode</code> while
annotating. You can also tweak the dark mode behavior in the settings
tab for the plugin.<br>
该插件具有内置的暗模式支持。要切换深色模式，请在注释时选择<code>更多选项</code>
<code>→ Toggle Dark Mode（切换深色模式</code> ）。您还可以在插件的
settings （设置） 选项卡中调整暗模式行为。</p>
<h3 id="linking-to-annotations">Linking to annotations</h3>
<p>链接到注释</p>
<p><a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator#linking-to-annotations"></a></p>
<p>An obsidian link to an annotation block-reference will, when clicked,
open the corresponding file and scroll to the associated highlight. If
the file is already open in a pane, then the link will cause the
existing pane to scroll instead.<br>
单击指向注释块引用的黑曜石链接将打开相应的文件并滚动到关联的高亮显示。如果文件已在窗格中打开，则该链接将导致现有窗格滚动。</p>
<h2 id="contributing">Contributing</h2>
<p>贡献</p>
<p><a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator#contributing"></a></p>
<p>Visit <a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a>
for information on building from source or contribution improvements. To
report a bug, ask a question or suggest an improvement for this plugin,
you can create an <a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator/issues">issue</a>.<br>
请访问 <a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a>
以获取有关从源构建或贡献改进的信息。要报告错误、提出问题或建议此插件的改进，您可以创建一个<a target="_blank" rel="noopener" href="https://github.com/elias-sundqvist/obsidian-annotator/issues">问题</a>
。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/24/Obsidian%20Annotator%20%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E5%A4%87%E5%BF%98%E5%BD%95/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/24/%E6%9C%AA%E5%91%BD%E5%90%8D/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/24/%E6%9C%AA%E5%91%BD%E5%90%8D/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-03-24 17:54:09" itemprop="dateCreated datePublished" datetime="2025-03-24T17:54:09+08:00">2025-03-24</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/22/Rust%E6%89%93%E5%8C%85%E4%B8%BAWASM%20%E5%BA%94%E7%94%A8%E4%BA%8EJavaScript%E5%89%8D%E7%AB%AF/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/22/Rust%E6%89%93%E5%8C%85%E4%B8%BAWASM%20%E5%BA%94%E7%94%A8%E4%BA%8EJavaScript%E5%89%8D%E7%AB%AF/" class="post-title-link" itemprop="url">Rust打包为WASM 应用于JavaScript前端</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-22 19:28:00 / 修改时间：20:39:46" itemprop="dateCreated datePublished" datetime="2025-03-22T19:28:00+08:00">2025-03-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>18 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="背景">背景</h2>
<p>在前端开发中，我们经常会遇到一些性能瓶颈，比如一些复杂的计算，或者一些需要大量计算的算法，这时候我们可以考虑使用WebAssembly来提高性能。</p>
<p>WebAssembly是一种新的低级字节码格式，可以在现代浏览器中运行，它可以让我们在浏览器中运行其他语言编写的代码，比如C、C++、Rust等。</p>
<p>Rust
因为其安全性可靠性以及高性能，以及跨平台的特性，非常适合用来编写WebAssembly模块。</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">### [Rust 和 WebAssembly 用例](https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#rust_和_webassembly_用例)</span><br><span class="line">Rust 和 WebAssembly 有两大主要用例：</span><br><span class="line"></span><br><span class="line">-   构建完整应用——整个 Web 应用都基于 Rust 开发！</span><br><span class="line">-   构建应用的组成部分——在现存的 JavaScript 前端中使用 Rust。</span><br><span class="line"></span><br><span class="line">目前，Rust 团队正专注于第二种用例，因此我们也将着重介绍它。对于第一种用例，可以参阅 [`yew`](https://github.com/DenisKolodin/yew) 这类项目。</span><br></pre></td></tr></tbody></table></figure>
<p>MDN网站上本身有一个简明的教程，用于介绍如何将Rust编写的程序打包为WebAssembly模块，然后在JavaScript中调用：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B">编译
Rust 为 WebAssembly - WebAssembly | MDN</a></p>
<p>MDN这篇文章写的非常通俗易懂，基本上是面向于零基础的读者，
但是问题是，这篇文章里面仍然有很多容易踩的坑，所以说，我在这结合我自己的实践、以及所遇到的问题，来写一篇更加详细的教程。</p>
<p>所以说这篇文章的大部分内容将会和 MDN
的文章一致，但是我会对其的一些内容进行删改，以及添加一些我认为有必要的内容。</p>
<h2 id="路径以及阶段性目标">路径以及阶段性目标</h2>
<p>在本教程中，我们将使用 Rust 的 npm 包构建工具 <code>wasm-pack</code>
来构建一个 npm 包。这个包只包含 WebAssembly 和 JavaScript
代码，以便包的用户无需安装 Rust 就能使用。他们甚至不需要知道这里包含
WebAssembly！</p>
<p>之后我们会使用 <code>vite</code>
框架来引入这个npm包，然后在前端项目中调用这个WebAssembly模块。</p>
<h2 id="安装-rust-环境"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#安装_rust_环境">安装
Rust 环境</a></h2>
<p>让我们看看安装 Rust 环境的所有必要步骤。</p>
<h3 id="安装-rust"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#安装_rust">安装
Rust</a></h3>
<p>前往 <a target="_blank" rel="noopener" href="https://www.rust-lang.org/install.html">Install
Rust</a> 页面并跟随指示安装
Rust。这里会安装一个名为“rustup”的工具，这个工具能让你管理多个不同版本的
Rust。默认情况下，它会安装用于惯常 Rust 开发的 stable 版本 Rust
Release。Rustup 会安装 Rust 的编译器 <code>rustc</code>、Rust
的包管理工具 <code>cargo</code>、Rust 的标准库 <code>rust-std</code>
以及一些有用的文档 <code>rust-docs</code>。</p>
<p><strong>备注：</strong> 需要注意，在安装完成后，你需要把 cargo 的
<code>bin</code> 目录添加到你系统的
<code>PATH</code>。一般来说它会自动添加，但需要你重启终端后才会生效。</p>
<h3 id="wasm-pack"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#wasm-pack">wasm-pack</a></h3>
<p>要构建我们的包，我们需要一个额外工具
<code>wasm-pack</code>。它会帮助我们把我们的代码编译成 WebAssembly
并制造出正确的 <code>npm</code> 包。使用下面的命令可以下载并安装它：</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo install wasm-pack</span><br></pre></td></tr></tbody></table></figure>
<h3 id="可选安装-node.js-并获取-npm-账户"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#安装_node.js_并获取_npm_账户">可选：安装
Node.js 并获取 npm 账户</a></h3>
<p>在这个例子中我们将会构建一个 npm 包，因此你需要确保安装 Node.js 和
npm 已经安装。</p>
<p>另外，我们将会把包发布到 npm 上，因此你还需要一个 npm
账号。它们是免费的。发布这个包并不是必须的，但是发布它非常简单，因此在本例中我们默认你会发布这个包。</p>
<p>这一步主要是为了，让你能够在本地测试你的WebAssembly模块，以及发布到npm上。之后其他的项目可以直接通过npm来同步更新你的WebAssembly模块，而无需手动操作。</p>
<p>在 <a target="_blank" rel="noopener" href="https://www.npmjs.com/get-npm">Get npm!</a>
页面按照说明下载并安装 Node.js 和
npm。在选择版本时，选择一个你喜欢的版本；本例不限定特定版本。</p>
<p>在 <a target="_blank" rel="noopener" href="https://www.npmjs.com/signup">npm signup page</a> 注册
npm 账户，并填写表格。</p>
<p>接下来，在命令行中运行 <code>npm adduser</code>: </p><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; npm adduser</span><br><span class="line"><span class="function">Username: <span class="title">yournpmusername</span></span></span><br><span class="line"><span class="function"><span class="title">Password</span>:</span></span><br><span class="line"><span class="function"><span class="title">Email</span>: (<span class="title">this</span> <span class="title">IS</span> <span class="title">public</span>) <span class="title">you</span>@<span class="title">example.com</span></span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>你需要完善你的用户名，密码和邮箱。如果成功了，你将会看到：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Logged in as yournpmusername on https://registry.npmjs.org/.</span><br></pre></td></tr></tbody></table></figure>
<p>在这里你可能会遇到两个问题： 1. 你被重定向到了 cnpm 而不是 npm
的网站。cnpm不支持公开账号的注册，它只允许你注册一个私人账号。</p>
<p>遇到这个问题是因为你之前可能遇到过 npm
无法安装某些模块的问题，之后在教程的指引下，使用了npmmirrow 淘宝镜像作为
npm
的源，当更改npm的源的时候，账号验证的源也会被设置为淘宝的镜像源。</p>
<p>解决方式有两个，一个是直接切换npm的源，但是这样，当你下次又有无法安装的而模块的时候，你又需要切换回来，最好的办法是自己手动指定一下登入账号使用的源：
</p><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm login --registry http://registry.npmjs.com</span><br></pre></td></tr></tbody></table></figure><p></p>
<ol start="2" type="1">
<li>密码和账号输入时无法确认是否输入正确且无法复制粘贴。</li>
</ol>
<p>使用 </p><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm login --username &lt;username&gt; --password &lt;password&gt; --email &lt;email&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>可以在命令行就指定这些参数，方便检查有无出错。
但是请注意请<strong>不要将这行命令添加到公开的文件</strong>里，以保护你的账号安全。</p>
<h2 id="构建我们的-webassembly-npm-包"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#构建我们的_webassembly_npm_包">构建我们的
WebAssembly npm 包</a></h2>
<p>万事俱备，来创建一个新的 Rust
包吧。打开你用来存放你私人项目的目录，做这些事：</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cargo new --lib hello-wasm</span><br><span class="line">     Created library `hello-wasm` project</span><br></pre></td></tr></tbody></table></figure>
<p>这里会在名为 <code>hello-wasm</code>
的子目录里创建一个新的库，里面有下一步之前你所需要的一切：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+-- Cargo.toml</span><br><span class="line">+-- src</span><br><span class="line">    +-- lib.rs</span><br></pre></td></tr></tbody></table></figure>
<p>首先，我们有一个 <code>Cargo.toml</code>
文件，这是我们配置构建的方式。如果你用过 Bundler 的 <code>Gemfile</code>
或者 npm 的 <code>package.json</code>，你应该会感到很熟悉。Cargo
的用法和它们类似。</p>
<p>接下来，Cargo 在 <code>src/lib.rs</code> 生成了一些 Rust 代码：</p>
<figure class="highlight rust"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests {</span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">it_works</span>() {</span><br><span class="line">        <span class="built_in">assert_eq!</span>(<span class="number">2</span> + <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>我们完全不需要使用这些测试代码，所以继续吧，我们删掉它。</p>
<h3 id="来写点-rust-代码吧"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#来写点_rust_代码吧！">来写点
Rust 代码吧！</a></h3>
<p>让我们在 <code>src/lib.rs</code> 写一些代码替换掉原来的：</p>
<figure class="highlight rust"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="keyword">crate</span> wasm_bindgen;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> wasm_bindgen::prelude::*;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[wasm_bindgen]</span></span><br><span class="line"><span class="keyword">extern</span> {</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">alert</span>(s: &amp;<span class="type">str</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">#[wasm_bindgen]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">greet</span>(name: &amp;<span class="type">str</span>) {</span><br><span class="line">    <span class="title function_ invoke__">alert</span>(&amp;<span class="built_in">format!</span>(<span class="string">"Hello, {}!"</span>, name));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>上面是MDN给的代码，它在后面给出了每个部分的解释，你可以点击这里跳转到原文进行查看：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#来写点_rust_代码吧！">来写点
Rust 代码吧！</a></p>
<p>不过我认为将注释和代码放在一起会更方便于参考，读者可以自行决定使用哪种方式。这里将会给出一个缺少部分细节的高级说明；如果想要了解更多
Rust 知识，请查看在线书籍 <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/">The
Rust Programming Language</a>。 </p><figure class="highlight rust"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">第一行就像在说“哇 Rust，我们在用一个叫做 wasm_bindgen 的库”。</span></span><br><span class="line"><span class="comment">在 Rust 当中，库被称为“crates”，因为我们使用的是一个外部库，所以有 "extern"。</span></span><br><span class="line"><span class="comment">明白了吗？ Cargo ships crates.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">crate</span> wasm_bindgen;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*第三行包括了一个将库中的代码引入到你的代码中的使用命令。</span></span><br><span class="line"><span class="comment">在这个情况下，将会引入 wasm_bindgen::prelude 的全部模块。</span></span><br><span class="line"><span class="comment">我们将在下一节中使用这些内容。 */</span></span><br><span class="line"><span class="keyword">use</span> wasm_bindgen::prelude::*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">在 #[] 中的内容叫做 "属性"，并以某种方式改变下面的语句。（其实有点类似于C#的属性）</span></span><br><span class="line"><span class="comment">#[wasm_bindgen] 后面跟着的语句是一个 extern，它将告诉 Rust 这下面的函数将由外部提供，我们想调用一些外部定义的函数。</span></span><br><span class="line"><span class="comment">而前面的这个属性标注告诉我们 这些函数将由 "wasm-bindgen" 来进行导入。(类似于 import {alert} from "wasm-bindgen")</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">这里的 alert 是 js 中的一个函数，它可以打开一个消息通知窗口，参数s为str类型，用于指示显示的内容。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">当你想调用新的 JavaScript 函数时，你可以在这里写他们，wasm-bindgen 将负责为你设置一切。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">并非一切都得到支持，但我们正在努力！</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#[wasm_bindgen]</span></span><br><span class="line"><span class="keyword">extern</span> {</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">alert</span>(s: &amp;<span class="type">str</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这里的 #[wasm_bindgen] 和上面的类似，但是这里，#[wasm_bindgen] 后面 跟着的不再是 extern，而是 pub fn。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">这代表我们希望能够在 JavaScript 中使用这个 Rust 函数。</span></span><br><span class="line"><span class="comment">这和 extern 正相反：我们并非引入函数，而是要把函数给外部世界使用。(类比到js里面就是 export {greet})</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">这个函数的名字是 greet，它需要一个参数，一个字符串（写作 &amp;str）。</span></span><br><span class="line"><span class="comment">它调用了我们前面在 extern 块中引入的 alert 函数。</span></span><br><span class="line"><span class="comment">它传递了一个让我们串联字符串的 format! 宏的调用。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#[wasm_bindgen]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">greet</span>(name: &amp;<span class="type">str</span>) {</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    format! 在这里有两个参数，一个格式化字符串和一个要填入的变量。</span></span><br><span class="line"><span class="comment">    格式化字符串是 "Hello, {}!" 部分。</span></span><br><span class="line"><span class="comment">    它可以包含一个或多个 {}，变量将会被填入其中。</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    传递的变量是 name，也就是这个函数的参数。</span></span><br><span class="line"><span class="comment">    所以当我们调用 greet("Steve")时我们就能看到 "Hello, Steve!"。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_ invoke__">alert</span>(&amp;<span class="built_in">format!</span>(<span class="string">"Hello, {}!"</span>, name));</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="把我们的代码编译到-webassembly"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#把我们的代码编译到_webassembly">把我们的代码编译到
WebAssembly</a></h3>
<p>为了能够正确的编译我们的代码，首先我们需要配置
<code>Cargo.toml</code>。打开这个文件，将内容改为如下所示：</p>
<p>Cargo.toml </p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">"hello-wasm"</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">"0.1.0"</span></span><br><span class="line"><span class="attr">authors</span> = [<span class="string">"Your Name &lt;you@example.com&gt;"</span>]</span><br><span class="line"><span class="attr">description</span> = <span class="string">"A sample project with wasm-pack"</span></span><br><span class="line"><span class="attr">license</span> = <span class="string">"MIT/Apache-2.0"</span></span><br><span class="line"><span class="attr">repository</span> = <span class="string">"https://github.com/yourgithubusername/hello-wasm"</span></span><br><span class="line"></span><br><span class="line"><span class="section">[lib]</span></span><br><span class="line"><span class="attr">crate-type</span> = [<span class="string">"cdylib"</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">wasm-bindgen</span> = <span class="string">"0.2"</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>你需要改为自己的仓库，同时 Cargo 需要通过 <code>git</code> 来完善
<code>authors</code> 部分。</p>
<p>最重要的是添加底下的部分。第一个部分 — <code>[lib]</code> — 告诉 Rust
为我们的包建立一个 <code>cdylib</code>
版本；在本教程中我们不会讲解它的含义。有关更多信息，请参阅 <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/cargo/guide/">Cargo</a> 和 <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/reference/linkage.html">Rust Linkage</a>
文档。</p>
<p>第二个部分是 <code>[dependencies]</code> 部分。在这里我们告诉 Cargo
我们需要依赖哪个版本的 <code>wasm-bindgen</code> ；在这个例子中，它是
<code>0.2.z</code> 版本的 (不是 <code>0.3.0</code> 或者其他版本)。</p>
<h3 id="构建包"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#构建包">构建包</a></h3>
<p>现在我们已经完成了所有配置项，开始构建吧！在命令行输入以下命令：</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wasm-pack build --scope mynpmusername</span><br></pre></td></tr></tbody></table></figure>
<p>或者</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wasm-pack build</span><br></pre></td></tr></tbody></table></figure>
<p>上面的方式会附带你的签名。</p>
<p>这个命令将做一系列事情 (这会花一些时间，特别是当你第一次运行
<code>wasm-pack</code>)。想了解详细情况，查看<a target="_blank" rel="noopener" href="https://hacks.mozilla.org/2018/04/hello-wasm-pack/">这篇在 Mozilla
Hacks 上的文章</a>。简单来说，<code>wasm-pack build</code>
将做以下几件事：</p>
<ol type="1">
<li>将你的 Rust 代码编译成 WebAssembly。</li>
<li>在编译好的 WebAssembly 代码基础上运行
<code>wasm-bindgen</code>，生成一个 JavaScript 文件将 WebAssembly
文件包装成一个模块以便 npm 能够识别它。</li>
<li>创建一个 <code>pkg</code> 文件夹并将 JavaScript 文件和生成的
WebAssembly 代码移到其中。</li>
<li>读取你的 <code>Cargo.toml</code> 并生成相应的
<code>package.json</code>。</li>
<li>复制你的 <code>README.md</code> (如果有的话) 到文件夹中。</li>
</ol>
<p>最后的结果？你在 <code>pkg</code> 文件夹下有了一个 npm 包。</p>
<h4 id="报错了对咯">报错了？对咯！</h4>
<p>教程的说明就截止到上面了，但是大概率，你报错了。</p>
<p>MDN的文章毕竟面对的是全球的开发者，但是在国内有一个比较烦的问题就是网络的访问，在执行<code>wasm-pack build</code>的时候，它会这样报错：</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E:\<span class="title">_Project</span>\<span class="title">Rust</span>\<span class="title">hello</span>-<span class="title">wasm</span>&gt;<span class="title">wasm</span>-<span class="title">pack</span> <span class="title">build</span></span></span><br><span class="line"><span class="function">[<span class="title">INFO</span>]: 🎯  <span class="title">Checking</span> <span class="title">for</span> <span class="title">the</span> <span class="title">Wasm</span> <span class="title">target</span>...</span></span><br><span class="line"><span class="function">[<span class="title">INFO</span>]: 🌀  <span class="title">Compiling</span> <span class="title">to</span> <span class="title">Wasm</span>...</span></span><br><span class="line"><span class="function"><span class="title">warning</span>: <span class="title">no</span> <span class="title">edition</span> <span class="title">set</span>: <span class="title">defaulting</span> <span class="title">to</span> <span class="title">the</span> 2015 <span class="title">edition</span> <span class="title">while</span> <span class="title">the</span> <span class="title">latest</span> <span class="title">is</span> 2024</span></span><br><span class="line"><span class="function">   <span class="title">Compiling</span> <span class="title">hello</span>-<span class="title">wasm</span> <span class="title">v0</span>.1.0 (<span class="title">E</span>:\<span class="title">_Project</span>\<span class="title">Rust</span>\<span class="title">hello</span>-<span class="title">wasm</span>)</span></span><br><span class="line"><span class="function">    <span class="title">Finished</span> `<span class="title">release</span>` <span class="title">profile</span> [<span class="title">optimized</span>] <span class="title">target</span>(<span class="title">s</span>) <span class="title">in</span> 0.99<span class="title">s</span></span></span><br><span class="line"><span class="function"><span class="title">Error</span>: <span class="title">failed</span> <span class="title">to</span> <span class="title">download</span> <span class="title">from</span> <span class="title">https</span>://<span class="title">github.com</span>/<span class="title">WebAssembly</span>/<span class="title">binaryen</span>/<span class="title">releases</span>/<span class="title">download</span>/<span class="title">version_117</span>/<span class="title">binaryen</span>-<span class="title">version_117</span>-<span class="title">x86_64</span>-<span class="title">windows.tar.gz</span></span></span><br><span class="line"><span class="function"><span class="title">To</span> <span class="title">disable</span> `<span class="title">wasm</span>-<span class="title">opt</span>`, <span class="title">add</span> `<span class="title">wasm</span>-<span class="title">opt</span> = <span class="title">false</span>` <span class="title">to</span> <span class="title">your</span> <span class="title">package</span> <span class="title">metadata</span> <span class="title">in</span> <span class="title">your</span> `<span class="title">Cargo.toml</span>`.</span></span><br><span class="line"><span class="function"><span class="title">Caused</span> <span class="title">by</span>: <span class="title">failed</span> <span class="title">to</span> <span class="title">download</span> <span class="title">from</span> <span class="title">https</span>://<span class="title">github.com</span>/<span class="title">WebAssembly</span>/<span class="title">binaryen</span>/<span class="title">releases</span>/<span class="title">download</span>/<span class="title">version_117</span>/<span class="title">binaryen</span>-<span class="title">version_117</span>-<span class="title">x86_64</span>-<span class="title">windows.tar.gz</span></span></span><br><span class="line"><span class="function"><span class="title">To</span> <span class="title">disable</span> `<span class="title">wasm</span>-<span class="title">opt</span>`, <span class="title">add</span> `<span class="title">wasm</span>-<span class="title">opt</span> = <span class="title">false</span>` <span class="title">to</span> <span class="title">your</span> <span class="title">package</span> <span class="title">metadata</span> <span class="title">in</span> <span class="title">your</span> `<span class="title">Cargo.toml</span>`.</span></span><br></pre></td></tr></tbody></table></figure>
<p>这里它说是无法下载 wasm-opt
这个东西，但是实际上我直接通过链接是能够直接下载的，网上说更改代理能够解决问题，我这里没有尝试这种方式，但是我还是将这种方法贴在这里：</p>
<p>如果你尝试通过cargo 去提前下载好 wasm-opt
的话，就会遇到另外一个问题，它一会给你报错无法找到c++编译器，但是实际上我的电脑里面安装了vs2019，所以说实际上根本不应该存在这个问题。当我将vs2019的cl.exe添加到环境变量之后，它又会报错说无法找到clang，之后我又去llvm的官网下载了clang，但是它又报错说<code>c++ 'algorithm' file not found</code>，这个问题我解决不了，暂时也不知道是为什么，这让我浪费了很多时间。</p>
<p>对于新学者来说，最好的办法就是按照它的提示的后者，将<code>wasm-opt = false</code>添加到你的<code>Cargo.toml</code>文件中，这样就可以跳过这个步骤，直接编译你的WebAssembly模块。wasm-opt
是一个优化工具，它会对你的WebAssembly模块进行优化，但是实际上，这个优化工具并不是必须的，你可以直接跳过这个步骤，直接编译你的WebAssembly模块。</p>
<p>对了，还有一个问题，就是它虽然叫你需要在 package metadata
中添加<code>wasm-opt = false</code>，但是实际上，你并不知道在哪里添加，需要翻阅官方文档:<a target="_blank" rel="noopener" href="https://rustwasm.github.io/wasm-pack/book/cargo-toml-configuration.html">Cargo.toml
Configuration - Hello wasm-pack!</a></p>
<blockquote>
<p><a href="chrome-extension://hajanaajapkhaabfcofdjgjnlgkdkknm/_generated_background_page.html#cargotoml-配置"><code>Cargo.toml</code>
配置</a></p>
<p><code>wasm-pack</code> 可以通过 <code>Cargo.toml</code> 中的
<code>package.metadata.wasm-pack</code> 键进行配置。
每个选项都有一个默认值，不是必需的。</p>
<p>共有三个配置文件：<code>dev</code>、<code>profiling</code> 和
<code>release</code>。 这些对应于传递给 <code>wasm-pack build</code> 的
<code>--dev</code>、<code>--profiling</code> 和 <code>--release</code>
标志。</p>
<p>可用的配置选项及其默认值如下所示： </p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package.metadata.wasm-pack.profile.dev]</span></span><br><span class="line"><span class="comment"># Should `wasm-opt` be used to further optimize the wasm binary generated after</span></span><br><span class="line"><span class="comment"># the Rust compiler has finished? Using `wasm-opt` can often further decrease</span></span><br><span class="line"><span class="comment"># binary size or do clever tricks that haven't made their way into LLVM yet.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Configuration is set to `false` by default for the dev profile, but it can</span></span><br><span class="line"><span class="comment"># be set to an array of strings which are explicit arguments to pass to</span></span><br><span class="line"><span class="comment"># `wasm-opt`. For example `['-Os']` would optimize for size while `['-O4']`</span></span><br><span class="line"><span class="comment"># would execute very expensive optimizations passes</span></span><br><span class="line"><span class="attr">wasm-opt</span> = [<span class="string">'-O'</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[package.metadata.wasm-pack.profile.dev.wasm-bindgen]</span></span><br><span class="line"><span class="comment"># Should we enable wasm-bindgen's debug assertions in its generated JS glue?</span></span><br><span class="line"><span class="attr">debug-js-glue</span> = <span class="literal">true</span></span><br><span class="line"><span class="comment"># Should wasm-bindgen demangle the symbols in the "name" custom section?</span></span><br><span class="line"><span class="attr">demangle-name-section</span> = <span class="literal">true</span></span><br><span class="line"><span class="comment"># Should we emit the DWARF debug info custom sections?</span></span><br><span class="line"><span class="attr">dwarf-debug-info</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[package.metadata.wasm-pack.profile.profiling]</span></span><br><span class="line"><span class="attr">wasm-opt</span> = [<span class="string">'-O'</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[package.metadata.wasm-pack.profile.profiling.wasm-bindgen]</span></span><br><span class="line"><span class="attr">debug-js-glue</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">demangle-name-section</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">dwarf-debug-info</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># `wasm-opt` is on by default in for the release profile, but it can be</span></span><br><span class="line"><span class="comment"># disabled by setting it to `false`</span></span><br><span class="line"><span class="section">[package.metadata.wasm-pack.profile.release]</span></span><br><span class="line"><span class="attr">wasm-opt</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[package.metadata.wasm-pack.profile.release.wasm-bindgen]</span></span><br><span class="line"><span class="attr">debug-js-glue</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">demangle-name-section</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">dwarf-debug-info</span> = <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><p></p>
</blockquote>
<p>通过翻阅文档，我们知道，我们需要在<code>package.metadata.wasm-pack.profile.release</code>中添加<code>wasm-opt = false</code>，这样就可以跳过这个步骤了。
修改后的<code>Cargo.toml</code>文件如下： </p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">"hello-wasm"</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">"0.1.0"</span></span><br><span class="line"><span class="attr">authors</span> = [<span class="string">"Your Name &lt;you@example.com&gt;"</span>]</span><br><span class="line"><span class="attr">description</span> = <span class="string">"A sample project with wasm-pack"</span></span><br><span class="line"><span class="attr">license</span> = <span class="string">"MIT/Apache-2.0"</span></span><br><span class="line"><span class="attr">repository</span> = <span class="string">"https://github.com/yourgithubusername/hello-wasm"</span></span><br><span class="line"></span><br><span class="line"><span class="section">[package.metadata.wasm-pack.profile.release]</span></span><br><span class="line"><span class="attr">wasm-opt</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[lib]</span></span><br><span class="line"><span class="attr">crate-type</span> = [<span class="string">"cdylib"</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">wasm-bindgen</span> = <span class="string">"0.2"</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<h4 id="对代码体积的一些说明">对代码体积的一些说明</h4>
<p>如果你检查生成的 WebAssembly 文件体积，它可能有几百 kB。我们没有让
Rust
去压缩生成的代码，从而大大减少生成包的体积。这和本次教程主题无关，但如果你想了解更多，查看
Rust WebAssembly 工作组文档上关于 <a target="_blank" rel="noopener" href="https://rustwasm.github.io/book/game-of-life/code-size.html#shrinking-wasm-size">减少
.wasm 体积</a> 的说明。</p>
<h3 id="把我们的包发布到-npm"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#把我们的包发布到_npm">把我们的包发布到
npm</a></h3>
<p>把我们的新包发布到 npm registry:</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> pkg</span><br><span class="line">npm publish --access=public</span><br></pre></td></tr></tbody></table></figure>
<p>我们现在有了一个 npm 包，使用 Rust 编写，但已经被编译为 WebAssembly
了。 现在这个包已经可以被 JavaScript
使用了，而且使用它完全不需要用户安装 Rust；包中的代码是 WebAssembly
代码，而不是 Rust 源码！</p>
<h2 id="在网站上使用我们的包"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#在网站上使用我们的包">在网站上使用我们的包</a></h2>
<p>让我们建立一个使用我们包的网站！人们通过各种打包工具使用 npm
包，在本教程中，我们将使用
<code>vite</code>。它比其他某些打包工具要更为的便捷，但是你可以使用任何你喜欢的工具。</p>
<p>从这里开始，将会和MDN的教程有所不同，因为我没有使用webpack，而是使用vite，所以说这里将会给出使用vite的教程。</p>
<p>让我们离开<code>pkg</code>目录，并创建一个新目录<code>site</code>，尝试以下操作：</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ../..</span><br><span class="line"><span class="built_in">mkdir</span> site</span><br><span class="line"><span class="built_in">cd</span> site</span><br></pre></td></tr></tbody></table></figure>
<p>创建一个新文件 <code>package.json</code>，然后输入如下代码：</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"scripts"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"dev"</span><span class="punctuation">:</span> <span class="string">"vite"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"dependencies"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"@mynpmusername/hello-wasm"</span><span class="punctuation">:</span> <span class="string">"^0.1.0"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"vite"</span><span class="punctuation">:</span> <span class="string">"^2.6.0"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"vite-plugin-top-level-await"</span><span class="punctuation">:</span> <span class="string">"^1.5.0"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"vite-plugin-wasm"</span><span class="punctuation">:</span> <span class="string">"^3.4.1"</span></span><br><span class="line">  <span class="punctuation">}</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
<p>如果上面你并没有将自己的包发布到npm上，那么你需要手动将上一步生成的<code>pkg</code>文件夹拷贝到<code>site</code>文件夹下，然后在<code>package.json</code>中将<code>dependencies</code>中的<code>@mynpmusername/hello-wasm</code>改为<code>file:./pkg</code>。</p>
<p>这样它将会从本地的<code>pkg</code>文件夹中引入你的WebAssembly模块。</p>
<p>如果上面你将自己的包发布到npm上了，那么请注意，你需要在依赖项部分的
<code>@</code> 之后填写自己的用户名。</p>
<p>接下来，我们需要配置 Vite 来使用 WebAssembly。创建一个新文件
<code>vite.config.js</code>，并输入如下内容：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { defineConfig } <span class="keyword">from</span> <span class="string">'vite'</span></span><br><span class="line"><span class="keyword">import</span> wasm <span class="keyword">from</span> <span class="string">'vite-plugin-wasm'</span></span><br><span class="line"><span class="keyword">import</span> topLevelAwait <span class="keyword">from</span> <span class="string">'vite-plugin-top-level-await'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>({</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">wasm</span>(),</span><br><span class="line">    <span class="title function_">topLevelAwait</span>()</span><br><span class="line">  ],</span><br><span class="line">    <span class="attr">optimizeDeps</span>: {</span><br><span class="line">    <span class="attr">exclude</span>: [<span class="string">'hello_wasm'</span>],</span><br><span class="line">}</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>这里的<code>optimizeDeps</code>是为了解决一个问题，就是vite会将你的WebAssembly模块当作一个模块来处理，但是实际上它并不是一个模块，所以说我们需要将它排除在外，防止vite对它进行处理，使得模块找不到对应的文件。</p>
<p>vite-plugin-wasm 是一个 Vite 插件，它会帮助你加载 WebAssembly
模块。vite-plugin-top-level-await 是一个 Vite 插件，它会帮助你使用顶层
await。</p>
<p>接下来，我们需要一个 HTML
文件。创建一个<code>index.html</code>并写入如下内容：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello-wasm example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    hello-wasm</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"testButton"</span>&gt;</span>Test Button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span> <span class="attr">src</span>=<span class="string">"./index.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>需要注意的是，MDN
里面使用的是<code>&lt;script src="./index.js"&gt;&lt;/script&gt;</code>，但是实际上，vite是不支持这种方式的，你需要使用<code>&lt;script type="module" src="./index.js"&gt;&lt;/script&gt;</code>这种方式来引入你的js文件。</p>
<p>这样的话，你可以在<code>index.js</code>中直接使用<code>import {greet} from '@mynpmusername/hello-wasm'</code>来引入你的WebAssembly模块，而不需要额外的处理。</p>
<p>现在我们来写<code>index.js</code>文件：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> wasm <span class="keyword">from</span> <span class="string">"hello-wasm"</span>;</span><br><span class="line"></span><br><span class="line">wasm.<span class="title function_">greet</span>(<span class="string">"WebAssembly"</span>);</span><br><span class="line"><span class="comment">//debug</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">debug</span>(<span class="string">"loaded"</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">"#testButton"</span>).<span class="title function_">addEventListener</span>(<span class="string">"click"</span>, <span class="function">() =&gt;</span> {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">debug</span>(<span class="string">"clicked button"</span>);</span><br><span class="line">    wasm.<span class="title function_">greet</span>(<span class="string">"WebAssembly"</span>);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>加载后，它将从该模块调用<code>greet</code>函数，并传入字符串“WebAssembly”参数。注意这里看上去没有什么特别的，但是我们正在调用
Rust 代码！就 JavaScript 代码所知，这只是一个普通模块。</p>
<p>我们已经完成了所有的文件！让我们试一下：</p>
<figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></tbody></table></figure>
<p>这将启动一个 Web 服务器。访问 vite
给出的链接，比如，<code>http://localhost:5178/</code>
你应该会在屏幕上看到一个内容为 <code>Hello, WebAssembly!</code>
的警告框。点击按钮时也会看到这个警告框。</p>
<p>我们已经成功地从 JavaScript 调用了 Rust，并从 Rust 调用了
JavaScript。</p>
<h2 id="结论"><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Guides/Rust_to_Wasm#rust_%E5%92%8C_webassembly_%E7%94%A8%E4%BE%8B#结论">结论</a></h2>
<p>本教程到此结束。希望你觉得它有用。</p>
<p>非常感谢来自 Rust 和 WebAssembly
社区的所有人，他们的工作使得这一切成为可能。
同样也非常感谢这位作者，他的文章非常通俗易懂，且提供了github上的代码仓库，让我们可以直接下载代码进行测试：
<a target="_blank" rel="noopener" href="https://blog.csdn.net/jethroHEX/article/details/136394323">我使用
vue3 + WebAssembly 做了个文件校验网站，性能提升600%_vue
webassembly-CSDN博客</a> <a target="_blank" rel="noopener" href="https://github.com/jethroHuang/fast_hash">jethroHuang/fast_hash</a></p>
<p>它的这里面还使用了worker来进一步提高性能，这里就不再赘述了，有兴趣的可以去看看。关于worker的内容，可以参考这篇文章：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API">Web
Workers API - Web APIs | MDN</a></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/22/Rust%E6%89%93%E5%8C%85%E4%B8%BAWASM%20%E5%BA%94%E7%94%A8%E4%BA%8EJavaScript%E5%89%8D%E7%AB%AF/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/22/Tauri%20%E5%88%9D%E4%BD%93%E9%AA%8C%EF%BC%9A%E5%89%8D%E9%80%94%E5%8F%AF%E6%9C%9F/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/22/Tauri%20%E5%88%9D%E4%BD%93%E9%AA%8C%EF%BC%9A%E5%89%8D%E9%80%94%E5%8F%AF%E6%9C%9F/" class="post-title-link" itemprop="url">Tauri 初体验：前途可期</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-22 08:52:00 / 修改时间：09:28:19" itemprop="dateCreated datePublished" datetime="2025-03-22T08:52:00+08:00">2025-03-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/electron/" rel="contents" data-pjax-state="">#
electron</a> <br></p>
<h2 id="tauri-初体验前途可期">Tauri 初体验：前途可期</h2>
<p>之前一直苦恼于 electron
打包出来的体积太大，总是想要使其的体积更小，对于使用者更加友好。</p>
<p>最近发现了一个新的框架：<a target="_blank" rel="noopener" href="https://tauri.studio/">Tauri</a>，它是一个基于 Rust 的框架，可以将
Rust
代码编译成一个可执行文件，然后将这个可执行文件和前端代码打包成一个可执行文件。</p>
<p>本身我就对 Rust 比较感兴趣，所以就尝试了一下。</p>
<p>但是结果就是……Tauri的开发体验简直是糟糕。</p>
<h2 id="简陋的开始">简陋的开始</h2>
<p>一开始使用一个简单的命令就可以创建一个基础的项目：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tauri create my-app</span><br></pre></td></tr></tbody></table></figure>
<p>在选择了一些配置项之后，就可以运行这个项目了：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line">tauri dev</span><br></pre></td></tr></tbody></table></figure>
<p>这个命令会启动一个开发服务器，然后打开一个窗口，显示你的应用。</p>
<p>一步步走到这里，一切都顺利，但是问题是：然后呢？</p>
<p>下面是它的文档的目录：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-   快速开始</span><br><span class="line">    </span><br><span class="line">    -   [什么是 Tauri？](https://v2.tauri.org.cn/start/)</span><br><span class="line">    -   [先决条件](https://v2.tauri.org.cn/start/prerequisites/)</span><br><span class="line">    -   [创建项目](https://v2.tauri.org.cn/start/create-project/)</span><br><span class="line">    -   前端配置</span><br><span class="line">        </span><br><span class="line">        -   [概述](https://v2.tauri.org.cn/start/frontend/)</span><br><span class="line">        -   [Leptos](https://v2.tauri.org.cn/start/frontend/leptos/)</span><br><span class="line">        -   [Next.js](https://v2.tauri.org.cn/start/frontend/nextjs/)</span><br><span class="line">        -   [Nuxt](https://v2.tauri.org.cn/start/frontend/nuxt/)</span><br><span class="line">        -   [Qwik](https://v2.tauri.org.cn/start/frontend/qwik/)</span><br><span class="line">        -   [SvelteKit](https://v2.tauri.org.cn/start/frontend/sveltekit/)</span><br><span class="line">        -   [Trunk](https://v2.tauri.org.cn/start/frontend/trunk/)</span><br><span class="line">        -   [Vite](https://v2.tauri.org.cn/start/frontend/vite/)</span><br><span class="line">        </span><br><span class="line">    -   升级与迁移</span><br><span class="line">        </span><br><span class="line">        -   [概述](https://v2.tauri.org.cn/start/migrate/)</span><br><span class="line">        -   [从 Tauri 1.0 升级](https://v2.tauri.org.cn/start/migrate/from-tauri-1/)</span><br><span class="line">        -   [从 Tauri 2.0 Beta 升级](https://v2.tauri.org.cn/start/migrate/from-tauri-2-beta/)</span><br></pre></td></tr></tbody></table></figure>
<p>在配置完前端（我使用的是vite）之后呢？让我们继续看看下面的非快速开始的内容：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">-   核心概念</span><br><span class="line">    </span><br><span class="line">    -   [概述](https://v2.tauri.org.cn/concept/)</span><br><span class="line">    -   [Tauri 架构](https://v2.tauri.org.cn/concept/architecture/)</span><br><span class="line">    -   [进程模型](https://v2.tauri.org.cn/concept/process-model/)</span><br><span class="line">    -   [应用大小](https://v2.tauri.org.cn/concept/size/)</span><br><span class="line">    -   进程间通信</span><br><span class="line">        </span><br><span class="line">        -   [概述](https://v2.tauri.org.cn/concept/inter-process-communication/)</span><br><span class="line">        -   [棕地模式](https://v2.tauri.org.cn/concept/inter-process-communication/brownfield/)</span><br><span class="line">        -   [隔离模式](https://v2.tauri.org.cn/concept/inter-process-communication/isolation/)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">-   安全性</span><br><span class="line">    </span><br><span class="line">    -   [概述](https://v2.tauri.org.cn/security/)</span><br><span class="line">    -   [权限](https://v2.tauri.org.cn/security/permissions/)</span><br><span class="line">    -   [命令作用域](https://v2.tauri.org.cn/security/scope/)</span><br><span class="line">    -   [功能](https://v2.tauri.org.cn/security/capabilities/)</span><br><span class="line">    -   [内容安全策略 (CSP)](https://v2.tauri.org.cn/security/csp/)</span><br><span class="line">    -   [HTTP 标头 新](https://v2.tauri.org.cn/security/http-headers/)</span><br><span class="line">    -   [Tauri 生态系统安全](https://v2.tauri.org.cn/security/ecosystem/)</span><br><span class="line">    -   [应用程序生命周期威胁](https://v2.tauri.org.cn/security/lifecycle/)</span><br><span class="line">    -   [未来工作](https://v2.tauri.org.cn/security/future/)</span><br><span class="line">    -   [运行时权限](https://v2.tauri.org.cn/security/runtime-authority/)</span><br><span class="line">    </span><br><span class="line">-   开发</span><br><span class="line">    </span><br><span class="line">    -   [概述](https://v2.tauri.org.cn/develop/)</span><br><span class="line">    -   [从 Rust 调用前端](https://v2.tauri.org.cn/develop/calling-frontend/)</span><br><span class="line">    -   [从前端调用 Rust](https://v2.tauri.org.cn/develop/calling-rust/)</span><br><span class="line">    -   [配置文件](https://v2.tauri.org.cn/develop/configuration-files/)</span><br><span class="line">    -   [嵌入其他文件](https://v2.tauri.org.cn/develop/resources/)</span><br><span class="line">    -   [嵌入外部二进制文件](https://v2.tauri.org.cn/develop/sidecar/)</span><br><span class="line">    -   [状态管理](https://v2.tauri.org.cn/develop/state-management/)</span><br><span class="line">    -   [更新依赖项](https://v2.tauri.org.cn/develop/updating-dependencies/)</span><br><span class="line">    -   调试</span><br><span class="line">        </span><br><span class="line">        -   [概述](https://v2.tauri.org.cn/develop/debug/)</span><br><span class="line">        -   [CrabNebula DevTools 新](https://v2.tauri.org.cn/develop/debug/crabnebula-devtools/)</span><br><span class="line">        -   [在 Neovim 中调试](https://v2.tauri.org.cn/develop/debug/neovim/)</span><br><span class="line">        -   [在 JetBrains IDE 中调试](https://v2.tauri.org.cn/develop/debug/rustrover/)</span><br><span class="line">        -   [在 VS Code 中调试](https://v2.tauri.org.cn/develop/debug/vscode/)</span><br><span class="line">        </span><br><span class="line">    -   插件</span><br><span class="line">        </span><br><span class="line">        -   [概述](https://v2.tauri.org.cn/develop/plugins/)</span><br><span class="line">        -   [移动插件开发](https://v2.tauri.org.cn/develop/plugins/develop-mobile/)</span><br><span class="line">        </span><br><span class="line">    -   测试</span><br><span class="line">        </span><br><span class="line">        -   [概述](https://v2.tauri.org.cn/develop/tests/)</span><br><span class="line">        -   [模拟 Tauri API](https://v2.tauri.org.cn/develop/tests/mocking/)</span><br><span class="line">        -   WebDriver</span><br><span class="line">            </span><br><span class="line">            -   [概述](https://v2.tauri.org.cn/develop/tests/webdriver/)</span><br><span class="line">            -   [持续集成](https://v2.tauri.org.cn/develop/tests/webdriver/ci/)</span><br><span class="line">            -   示例</span><br><span class="line">                </span><br><span class="line">                -   [设置](https://v2.tauri.org.cn/develop/tests/webdriver/example/)</span><br><span class="line">                -   [Selenium](https://v2.tauri.org.cn/develop/tests/webdriver/example/selenium/)</span><br><span class="line">                -   [WebdriverIO](https://v2.tauri.org.cn/develop/tests/webdriver/example/webdriverio/)</span><br><span class="line">    </span><br><span class="line">-   分发</span><br><span class="line">    </span><br><span class="line">    -   [概述](https://v2.tauri.org.cn/distribute/)</span><br><span class="line">    - ……后面略去</span><br></pre></td></tr></tbody></table></figure>
<p>进程间通信这里，它在概述里面介绍了它使用的是类似于 IPC
的方式，但是问题是具体的调用方式在哪里呢？它没有举例子，而文档直到后面的
<a target="_blank" rel="noopener" href="https://v2.tauri.org.cn/develop/calling-frontend/">从 Rust
调用前端</a> 才有介绍。</p>
<p>而且它也没讲解入口文件是哪个？主进程和渲染进程中主进程是在哪个文件中启动的？</p>
<h2 id="模糊的文档">模糊的文档</h2>
<p>更为好笑的是：</p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> {invoke} <span class="keyword">from</span> <span class="string">'@tauri-apps/api/tauri'</span></span><br></pre></td></tr></tbody></table></figure>
<p>这个示例用的代码无法运行，因为它找不到这个模块。为什么找不到呢？因为它安装tauri的时候并不默认包含它的api，而是需要手动安装：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @tauri-apps/api</span><br></pre></td></tr></tbody></table></figure>
<p>欸，你认为这就结束了吗？不，它的文档也没有提到这个模块到底是哪里的，它在：</p>
<figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> {invoke} <span class="keyword">from</span> <span class="string">'@tauri-apps/api/core'</span></span><br></pre></td></tr></tbody></table></figure>
<p>这个模块中。而不是教程中的 <code>@tauri-apps/api/tauri</code>。</p>
<p>初次之外，类似的事情还在文件系统上，在文档中它说：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 文件系统</span><br><span class="line"></span><br><span class="line">[GitHub](https://github.com/tauri-apps/plugins-workspace/tree/v2/plugins/fs) [npm](https://npmjs.net.cn/package/@tauri-apps/plugin-fs) [crates.io](https://crates.io/crates/tauri-plugin-fs)</span><br><span class="line"></span><br><span class="line">API 参考[](https://v2.tauri.org.cn/reference/javascript/fs/)[](https://docs.rs/tauri-plugin-fs)</span><br><span class="line"></span><br><span class="line">访问文件系统。</span><br><span class="line"></span><br><span class="line">## [支持的平台](https://v2.tauri.org.cn/plugin/file-system/#_top#supported-platforms)</span><br><span class="line"></span><br><span class="line">_此插件需要 Rust 版本至少为 **1.77.2**_</span><br><span class="line"></span><br><span class="line">| 平台 | 级别 | 注意 |</span><br><span class="line">| --- | --- | --- |</span><br><span class="line">| windows | | 通过 MSI 或 NSIS 安装在 `perMachine` 和 `both` 模式下的应用，需要在 `$RESOURCES` 文件夹中进行写入访问时需要管理员权限|</span><br><span class="line">| linux | | 无法写入访问 `$RESOURCES` 文件夹|</span><br><span class="line">| macos | | 无法写入访问 `$RESOURCES` 文件夹|</span><br><span class="line">| android | | 默认情况下，访问权限仅限于应用程序文件夹 |</span><br><span class="line">| ios | | 默认情况下，访问权限仅限于应用程序文件夹|</span><br></pre></td></tr></tbody></table></figure>
<p>但是在另外一处，它说：</p>
<p></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 文件系统</span><br><span class="line">fs模块可以使用 window.__TAURI__.fs 来访问文件系统。</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>但是实际上这种方式是无法使用的，因为它需要先安装
<code>@tauri-apps/api/fs</code>，而不是
<code>@tauri-apps/plugin-fs</code>。</p>
<p>欸，但是 2.0 版本的 fs 模块已经被默认移除了，需要使用 plugin-fs。</p>
<p>## 缺失的功能</p>
<p>我写的程序为了优化性能，使用了creatlink而非copy，但是在tauri中并没有这个功能，所以我需要自己写一个rust后端来实现这个功能并且还需要处理多平台的问题，要么就是仍然使用
nodejs 作为依赖。</p>
<p>但是这样的话，tauri的优势就没有了，因为我还是需要依赖 nodejs。</p>
<p>……</p>
<h2 id="总结">总结</h2>
<p>只能说未来可期，但是现在的体验真的是太差了，文档不全，不清晰，而且还有很多坑，不建议使用。</p>
<p>不过rust的编程的思路很有意思，虽然说编程的时候碍手碍脚的，但是因为其稳定性和性能，还是值得一试的。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/22/Tauri%20%E5%88%9D%E4%BD%93%E9%AA%8C%EF%BC%9A%E5%89%8D%E9%80%94%E5%8F%AF%E6%9C%9F/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/20/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%BA%8C%E5%A4%A9/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/20/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%BA%8C%E5%A4%A9/" class="post-title-link" itemprop="url">AI绘画入门学习-第二天</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-03-20 21:56:00" itemprop="dateCreated datePublished" datetime="2025-03-20T21:56:00+08:00">2025-03-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-26 22:25:04" itemprop="dateModified" datetime="2025-03-26T22:25:04+08:00">2025-03-26</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>7 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/AI绘画/" rel="contents" data-pjax-state="">#
AI绘画</a> <br> ## <strong>Day 2：提示词与参数优化</strong></p>
<p><strong>学习目标</strong>：掌握提示词编写技巧，调整参数提升生成质量。
- <strong>实践步骤</strong>： 1.
<strong>提示词公式</strong>：使用“主体+细节+风格+质量”结构（如“a knight
in armor, detailed armor texture, dark fantasy style, 8k,
masterpiece”）。 2.
<strong>权重控制</strong>：用<code>(keyword:1.5)</code>增强权重，<code>[keyword]</code>降低权重。
3. <strong>参数调整</strong>： -
采样方法：推荐<code>DPM++ 2M Karras</code>（速度快且稳定）。 -
迭代步数：20-30步（平衡速度与质量）。 - 提示词相关性（CFG
Scale）：7-12（值越高越贴近描述，但可能过锐化）。 -
<strong>检验成果</strong>：生成一张符合复杂提示词描述的图片（如“科幻城市夜景，赛博朋克风格”）。</p>
<p>为此我研读了这本书，<a target="_blank" rel="noopener" href="https://docs.qq.com/doc/DWFdSTHJtQWRzYk9k">元素同典：确实不完全科学的魔导书</a></p>
<p>我会在另外一篇文章里面分享自己的
结合书本中的知识以的实战经历[[元素同典：确实不完全科学的魔导书
批注]]</p>
<h2 id="预制提示词测试">预制提示词测试</h2>
<p>这里，大佬给了一个非常棒的风格模板，后面加上想要的提示词大概率能出非常好的图像效果：</p>
<p><img src="/2024/03/01/3.Source/00086-1533094715.png" alt="00086-1533094715.png" align="right" width="38%"></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(masterpiece, extremely detailed 8k wallpaper,best quality),(best illumination, best shadow, extremely delicate and beautiful),dynamic angle,floating,finely detail,Depth of field (bloom),(shine),glinting stars,classic,(illustration),(painting),(sketch),1girl,solo,bare shoulders,medium breasts,areola,red eyes,beautiful detailed cold face,black hair,straight_hair,short hair,extremely delicate and beautiful girls,beautiful detailed eyes,(((rose))),cage,bandage,(red rope),  </span><br><span class="line">Negative prompt: lowres,bad anatomy,bad hands,text,error,missing fingers,extra digit,fewer digits,cropped,worst quality,low quality,normal quality,jpeg artifacts,signature,watermark,username,blurry,sketches,EasyNegativeV2,badhandv4,  </span><br><span class="line">Steps: 18, Sampler: DPM++ 2M, Schedule type: Karras, CFG scale: 7, Seed: 1533094715, Size: 512x512, Model hash: 7f96a1a9ca, Model: anything-v5, Denoising strength: 0.7, Clip skip: 2, Hires upscale: 2, Hires upscaler: Latent, TI hashes: "EasyNegativeV2: 339cc9210f70, badhandv4: 5e40d722fc3d", Version: v1.10.1</span><br></pre></td></tr></tbody></table></figure>
<h2 id="迭代步数和采样方式对结果的影响">迭代步数和采样方式对结果的影响</h2>
<p>在控制同一个seed的情况下，我们可以用 X/Y参照来生成对比图像：</p>
<p>这里，我用提示词为： </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masterpiece,1 girl,cute face,black short hair,red eyes,[SFW:(NSFW:1):0.1],</span><br></pre></td></tr></tbody></table></figure> 负面提示词为： <figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lowres,bad anatomy,bad hands,text,error,missing fingers,extra digit,</span><br><span class="line">fewer digits,cropped,worst quality,low quality,normal quality,jpeg artifacts,</span><br><span class="line">signature,watermark,username,blurry,bad fee,</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2024/03/01/3.Source/xyz_grid-0001-13877462132.jpg"></p>
<h2 id="镜头控制">镜头控制</h2>
<p>close up、close shot、medium view、panorama
这几个镜头控制十分好用</p>
<h2 id="吟唱方式">吟唱方式</h2>
<p>常见的吟唱方式有三种： 1. 字节式 ## 提示词的分割</p>
<h2 id="语法功能">语法功能</h2>
<h3 id="提示词">提示词</h3>
<p>提示词是用于提示ai需要生成什么样式的图片的引导词，ai会根据你的提示词生成图片。</p>
<p>为什么提示词会有效我们可以从文生图的原理说起：
SD等模型使用的都是让使用将一个带有若干个标签的图片，通过不断参杂噪声，让其变为一张纯噪声图作为正向过程让ai去学习，而这个参杂的过程在一定程度上是可逆的，所以说将ai通过这种方式得到的一系列参数求一个逆，我们就可以得到一个能够从一个噪声图生成为我们想要的图片的模型。</p>
<p>也就是说，提示词本质上就是一开始用来训练ai的图片上面带着的标签，了解训练ai的数据的来源，我们可以直到每个标签大概指的是什么意思：<a target="_blank" rel="noopener" href="https://danbooru.donmai.us/">Danbooru: Anime Image Board</a></p>
<p>但是它们可能有的好用有的不好用，一般引用数大于2000的tag都能够出比较好的效果。</p>
<p>这里还有一些小伙伴们自己收集的比较好的tag资料：
https://kdocs.cn/l/cre0TwbMkdx3
https://pan.baidu.com/s/11SE4uW0TiXqrHotBfT3hsQ?pwd=pdlk</p>
<p>然后这里是一些比较好的提示词组合，可以以此为范例： <a target="_blank" rel="noopener" href="https://docs.qq.com/doc/DWHFOd2hDSFJaamFm?nlc=1">元素法典
第二点五卷——Novel AI 元素魔法全收录</a> <a target="_blank" rel="noopener" href="https://docs.qq.com/doc/DWEpNdERNbnBRZWNL?dver=">元素法典
第二卷——Novel AI 元素魔法全收录</a> 等等</p>
<h3 id="提示词-权重调整方法">提示词 权重调整方法</h3>
<p>权重控制在咒语中非常重要，这关系着你想要的东西是否合乎心意的获得了AI的重视。</p>
<p>最基础的权重控制为控制prompt在咒语中的位置。越靠前的词汇越受到重视。</p>
<p>权重控制可以通过对prompt加括号进行。() 或 {} 为加强权重，[]
为减弱权重，括号可以一次扩多个词条。(1girl:1.5)括号后对添加
":1.5"是对词条直接赋予权重，数字即为权重大小。数字越大权重越大，默认1，通常为0-2之间。</p>
<p>目前在webui中()为对其中内容权重乘以1.1，[]为对其中内容除以1.1，而{}在webui版本中不生效。虽然多重括号也能生效，但是这种方法低效且不优雅，例如((((girl))))进行了4次括号，但是只对girl权重增加到了1.4641。</p>
<p>这里强烈推荐使用(prompt:权重数)的方式来进行权重调整。</p>
<p>比如，你可以在提示词中加入[]，然后在括号中加入权重数，这样就可以对整个括号内的词条进行权重调整。</p>
<p>此外，webui还支持快速调节：选中一组词，然后按方向键上下（根据编译器版本不同可能是ctrl+方向键）可以直接完成权重调整。</p>
<h3 id="权重调整的高阶技巧">权重调整的高阶技巧</h3>
<p>除了上面的方法可以调整权重之外，还可以使用· </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[from:to:step]</span><br></pre></td></tr></tbody></table></figure>
来配置阶段性的权重调整。<p></p>
<p>它可以在步数进行到 某一阶段时，将prompt 从 from 变成 to。</p>
<p>比如我个人觉得比较好用的一个是<code>[SFW:NSFW:0.1]</code>
，这样可以在推理的早些阶段，生成一个 SFW
的底图，之后，在经过了整体步数的 10% 之后，再转换为 NSFW 的图像。</p>
<p>这样可以保证擦边球的图像不会在早期就生成，而是在后期生成，从而保证了生成的图像的质量。</p>
<h2 id="书写技巧">书写技巧</h2>
<p>上面是单个词的方法，但是实际上我们需要的画面并不能使用寥寥几个词就能够描述，想要生成出好的效果，往往需要在多个方面去对于画面进行描述，对于画面中的元素进行控制，这就需要我们将多个提示词组合起来，构成一整句“咒语”。</p>
<h3 id="三种常见的书写方式及其异同">三种常见的书写方式及其异同</h3>
<p>这里直接引用 [[元素同典：确实不完全科学的魔导书.pdf]]
里面的原文了：</p>
<p>咏唱大致有着三种不同形式——最常见的直接咏唱、稍不常见的短句咏唱和堪称行为艺术一般的长咏唱。</p>
<p>假设要生成一个有着黄色头发、蓝色眼眸、白色上衣、红色裙子、黑色裤袜的全身坐姿二次元美少女，且强调服饰颜色，那么这三种咏唱分别看上去大概是这样的：</p>
<p>直接咏唱(pitch 式咏唱)：</p>
<p>masterpiece, best quality, 1 girl, (blue eyes), (yellow hair), (white
clothes), (red skirt), (black leggings), sitting, full body</p>
<p>短句咏唱(AND 强调咏唱)：</p>
<p>masterpiece, best quality, 1 girl, (blue eyes) AND (yellow hair),
(white clothes) AND (red skirt) AND (black leggings), sitting, full
body</p>
<blockquote>
<p>注意短句咏唱的 AND 必须是三个大写字母，AND
两侧的小括号是不必要的(但建议加上)，这是一个专用语法，不过因为效果仍未明晰所以不单独介绍。此外，该语法并不能应用于所有采样方法，例如
DDIM 就不支持 AND，会导致报错。</p>
<p>这里似乎有点问题，大写“AND”会导致碎片化图片，但是小写“and”反而可以正常出图，估计是版本更新的问题</p>
</blockquote>
<p>长咏唱(自然语言咏唱)：</p>
<p>masterpiece, best quality, (1 girl with blue eyes and yellow hair
wearing white clothes and red skirt with black leggings), sitting, full
body</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/20/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%BA%8C%E5%A4%A9/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/20/AI%E7%BB%98%E7%94%BB-%E7%A0%94%E8%AF%BB%E3%80%8ATags%E5%9F%BA%E6%9C%AC%E7%BC%96%E5%86%99%E9%80%BB%E8%BE%91%E5%8F%8A%E4%B8%89%E6%AE%B5%E6%9C%AF%E5%BC%8F%E5%85%A5%E9%97%A8%E4%B8%8E%E8%A7%A3%E6%9E%90%E3%80%8B/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/20/AI%E7%BB%98%E7%94%BB-%E7%A0%94%E8%AF%BB%E3%80%8ATags%E5%9F%BA%E6%9C%AC%E7%BC%96%E5%86%99%E9%80%BB%E8%BE%91%E5%8F%8A%E4%B8%89%E6%AE%B5%E6%9C%AF%E5%BC%8F%E5%85%A5%E9%97%A8%E4%B8%8E%E8%A7%A3%E6%9E%90%E3%80%8B/" class="post-title-link" itemprop="url">AI绘画-研读《Tags基本编写逻辑及三段术式入门与解析》</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-20 21:16:00 / 修改时间：21:34:23" itemprop="dateCreated datePublished" datetime="2025-03-20T21:16:00+08:00">2025-03-20</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>64</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/未完成/" rel="contents" data-pjax-state="">#
未完成</a> <br>
<a href="/tags/AI绘画/" rel="contents" data-pjax-state=""># AI绘画</a>
<br></p>
<h3 id="ai绘画-研读tags基本编写逻辑及三段术式入门与解析">AI绘画-研读《Tags基本编写逻辑及三段术式入门与解析》</h3>
<p>看到一个很好的文档，在这里分享一下：</p>
<p><a target="_blank" rel="noopener" href="https://docs.qq.com/doc/DSHBGRmRUUURjVmNM">Tags基本编写逻辑及三段术式入门与解析v3</a></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/20/AI%E7%BB%98%E7%94%BB-%E7%A0%94%E8%AF%BB%E3%80%8ATags%E5%9F%BA%E6%9C%AC%E7%BC%96%E5%86%99%E9%80%BB%E8%BE%91%E5%8F%8A%E4%B8%89%E6%AE%B5%E6%9C%AF%E5%BC%8F%E5%85%A5%E9%97%A8%E4%B8%8E%E8%A7%A3%E6%9E%90%E3%80%8B/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/20/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%B8%80%E5%A4%A9/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/20/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%B8%80%E5%A4%A9/" class="post-title-link" itemprop="url">AI绘画入门学习-第一天</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-20 07:46:00 / 修改时间：22:02:07" itemprop="dateCreated datePublished" datetime="2025-03-20T07:46:00+08:00">2025-03-20</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/AI绘画/" rel="contents" data-pjax-state="">#
AI绘画</a> <br></p>
<h2 id="day-1安装环境与基础生成"><strong>Day
1：安装环境与基础生成</strong></h2>
<p><strong>学习目标</strong>：完成Stable
Diffusion本地部署，生成第一张AI图片。 - <strong>实践步骤</strong>： 1.
下载秋葉整合包（解压密码：<code>bilibili@秋葉aaaki</code>），安装.NET依赖项，双击启动器一键运行。
2.
打开WebUI界面（默认地址<code>http://127.0.0.1:7860</code>），输入简单提示词（如“1
girl, masterpiece”），生成测试图。 3.
熟悉界面功能：模型切换、提示词输入区、生成参数（采样方法、迭代步数）。 -
<strong>检验成果</strong>：成功生成一张基础图片（如猫或人物）。 -
<strong>学习资料</strong>： - 秋葉整合包安装教程：<a target="_blank" rel="noopener" href="https://blog.csdn.net/A1353192296/article/details/144258361">CSDN博客</a>。
- 界面功能速查表（见下文）。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/20/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E7%AC%AC%E4%B8%80%E5%A4%A9/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/19/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E6%A6%82%E8%BF%B0/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/19/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E6%A6%82%E8%BF%B0/" class="post-title-link" itemprop="url">AI绘画入门学习-概述</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-03-19 22:20:00" itemprop="dateCreated datePublished" datetime="2025-03-19T22:20:00+08:00">2025-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-20 21:56:40" itemprop="dateModified" datetime="2025-03-20T21:56:40+08:00">2025-03-20</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/未完成/" rel="contents" data-pjax-state="">#
未完成</a> <br>
<a href="/tags/AI绘画/" rel="contents" data-pjax-state=""># AI绘画</a>
<br></p>
<p>我从今天开始正式立一个小的目标要开始入门学习AI绘画入门，这一篇文章主要是作为提纲挈领的作用，用于为我自己明确目标并且梳理学习的路径。</p>
<h2 id="最终目标">最终目标：</h2>
<p>达到类似于这样的效果： <img src="/2024/03/01/3.Source/Pasted%20image%2020250319222837.png"> <img src="/2024/03/01/3.Source/Pasted%20image%2020250319223102.png"></p>
<p><img src="/2024/03/01/3.Source/Pasted%20image%2020250319223141.png"></p>
<p>嗯，我对于背景没有太大的要求，上面的图来自于这两个账号：</p>
<p><a target="_blank" rel="noopener" href="https://x.com/sagawa_gawa">(13) さがわ/sagawa (<span class="citation" data-cites="sagawa_gawa">@sagawa_gawa</span>) / X</a>
<a target="_blank" rel="noopener" href="https://x.com/lilydisease">(13) lilium (<span class="citation" data-cites="lilydisease">@lilydisease</span>) / X</a></p>
<p>虽然这几张图都有或多或少的问题，但是对于光影的把控已经非常到位了，对于肉感也有非常好的刻画。</p>
<h2 id="目标拆分">目标拆分：</h2>
<p>我现在想要将我的目标拆分为几个小的目标，但是我对这个并不熟悉，所以我希望使用ai帮我规划一下学习路线：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">你好，现在请你扮演一位对于AI绘画拥有丰富了解的学姐，现在我希望你能够帮助我入门ai绘画，我拥有 4060ti16G 以及 48G的内存，对于ai绘画的入门应该够用了。</span><br><span class="line">我现在的目标是：</span><br><span class="line">1. 能够使用ai绘画为我生成指定内容的图片</span><br><span class="line">2. 能够通过某种方式来调整图片生成的画风</span><br><span class="line">3. 能够使用通过某种方式来精准的控制画面中的角色（比如说我自己设定的角色或者其他动漫游戏作品中的角色）</span><br><span class="line">4. 能够通过某种方式精确的控制画面中的场景以及人物的动作</span><br><span class="line"></span><br><span class="line">我知道我上面的目标的描述可能会有些模糊，这是因为毕竟对于ai绘画来说是一个门外汉，我希望你能够帮我梳理并总结我的目标，我现在正在计划按照秋葉aaaki的教程来进行学习，但是这位大佬并没有给出详细的学习路线，我希望我能够在一周的时间内快速入门并且达到上述目标，我每天能够抽出至少2个小时的时间用于学习这方面的知识。另外，我认为最好的学习方式就是实践，希望你能够尽可能让我在实践的过程中学习。</span><br><span class="line"></span><br><span class="line">我希望你能够针对上述我的目标以及学习计划，为我规划一条路线清晰的学习路线，告诉我每个阶段的学习资料，学习目标，如何检验我的学习成果，非常感谢！</span><br></pre></td></tr></tbody></table></figure>
<p>DeepSeek的回答： ###
<strong>AI绘画入门学习路线规划（7天实践版）</strong>
<strong>硬件说明</strong>：你的配置（RTX 4060Ti 16G显存 +
48G内存）完全满足Stable
Diffusion本地部署需求，可高效运行模型和插件。</p>
<hr>
<h3 id="学习目标与阶段拆解"><strong>学习目标与阶段拆解</strong></h3>
<p>根据你的需求，目标可总结为： 1.
<strong>基础生成</strong>：能通过文本描述生成指定内容的图片。 2.
<strong>风格控制</strong>：调整画面风格（如动漫、写实、油画等）。 3.
<strong>角色控制</strong>：精准生成特定角色（自定义或已有IP）。 4.
<strong>场景与动作控制</strong>：控制构图、人物动作、场景细节。</p>
<p><strong>学习核心工具</strong>：秋葉aaaki整合包（Stable Diffusion
WebUI中文版）+ ControlNet插件 + LoRA模型。</p>
<hr>
<h3 id="每日学习计划"><strong>每日学习计划</strong></h3>
<h4 id="day-1安装环境与基础生成"><strong>Day
1：安装环境与基础生成</strong></h4>
<p>[[AI绘画入门学习-第一天]] <strong>学习目标</strong>：完成Stable
Diffusion本地部署，生成第一张AI图片。 - <strong>实践步骤</strong>： 1.
下载秋葉整合包（解压密码：<code>bilibili@秋葉aaaki</code>），安装.NET依赖项，双击启动器一键运行。
2.
打开WebUI界面（默认地址<code>http://127.0.0.1:7860</code>），输入简单提示词（如“1
girl, masterpiece”），生成测试图。 3.
熟悉界面功能：模型切换、提示词输入区、生成参数（采样方法、迭代步数）。 -
<strong>检验成果</strong>：成功生成一张基础图片（如猫或人物）。 -
<strong>学习资料</strong>： - 秋葉整合包安装教程：<a target="_blank" rel="noopener" href="https://blog.csdn.net/A1353192296/article/details/144258361">CSDN博客</a>。
- 界面功能速查表（见下文）。</p>
<hr>
<h4 id="day-2提示词与参数优化"><strong>Day
2：提示词与参数优化</strong></h4>
<p>[[AI绘画入门学习-第二天]]
<strong>学习目标</strong>：掌握提示词编写技巧，调整参数提升生成质量。 -
<strong>实践步骤</strong>： 1.
<strong>提示词公式</strong>：使用“主体+细节+风格+质量”结构（如“a knight
in armor, detailed armor texture, dark fantasy style, 8k,
masterpiece”）。 2.
<strong>权重控制</strong>：用<code>(keyword:1.5)</code>增强权重，<code>[keyword]</code>降低权重。
3. <strong>参数调整</strong>： -
采样方法：推荐<code>DPM++ 2M Karras</code>（速度快且稳定）。 -
迭代步数：20-30步（平衡速度与质量）。 - 提示词相关性（CFG
Scale）：7-12（值越高越贴近描述，但可能过锐化）。 -
<strong>检验成果</strong>：生成一张符合复杂提示词描述的图片（如“科幻城市夜景，赛博朋克风格”）。
- <strong>学习资料</strong>： - 提示词手册（附常用风格关键词）：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_59236602/article/details/144736778">CSDN资源包</a>。</p>
<hr>
<h4 id="day-3风格控制与模型管理"><strong>Day
3：风格控制与模型管理</strong></h4>
<p><strong>学习目标</strong>：切换不同大模型（底模）和LoRA插件调整画风。
- <strong>实践步骤</strong>： 1. <strong>下载模型</strong>：从<a target="_blank" rel="noopener" href="https://civitai.com/">Civitai</a>下载风格化大模型（如动漫风<code>Anything V5</code>、写实风<code>Realistic Vision</code>）。
2.
<strong>加载模型</strong>：将<code>.safetensors</code>文件放入<code>models/Stable-diffusion</code>文件夹，在WebUI中切换。
3.
<strong>使用LoRA</strong>：下载角色/风格LoRA模型（如<code>Genshin Impact角色LoRA</code>），在提示词中添加触发词（如<code>&lt;lora:genshin_zhongli:0.8&gt;</code>）。
-
<strong>检验成果</strong>：用同一提示词生成不同风格的图片（如“古风少女”分别用动漫和写实模型输出）。
- <strong>学习资料</strong>： - 模型管理教程：<a target="_blank" rel="noopener" href="https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki">SD
WebUI文档</a>。</p>
<hr>
<h4 id="day-4精准控制角色controlnet-lora"><strong>Day
4：精准控制角色（ControlNet + LoRA）</strong></h4>
<p><strong>学习目标</strong>：通过ControlNet插件固定角色形象，结合LoRA定制角色。
- <strong>实践步骤</strong>： 1.
<strong>安装ControlNet</strong>：在秋葉整合包中启用插件，下载预处理器和模型文件。
2.
<strong>线稿控制</strong>：上传角色线稿，启用<code>ControlNet</code>的<code>Canny</code>或<code>Lineart</code>模式，生成与线稿一致的角色。
3.
<strong>训练自定义LoRA</strong>：使用Kohya脚本训练个人角色（需准备20-30张角色多角度图片）。
-
<strong>检验成果</strong>：生成与线稿或自定义LoRA匹配的角色（如“我的自设角色，蓝色长发，机械臂”）。
- <strong>学习资料</strong>： - ControlNet教程：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1iM…">B站视频</a>。</p>
<hr>
<h4 id="day-5场景与动作控制controlnet进阶"><strong>Day
5：场景与动作控制（ControlNet进阶）</strong></h4>
<p><strong>学习目标</strong>：利用ControlNet控制构图、人物姿势、场景深度。
- <strong>实践步骤</strong>： 1.
<strong>姿势控制</strong>：使用<code>OpenPose</code>预处理器，上传姿势参考图，生成相同动作的角色。
2.
<strong>场景控制</strong>：用<code>Depth</code>模式输入场景深度图，控制画面层次感。
3.
<strong>分镜提示词</strong>：结合分镜描述（如“人物站在悬崖边，左手持剑，右手指向远方”）。
-
<strong>检验成果</strong>：生成指定动作和场景的图片（如“骑士骑马冲锋，背景是雪山”）。
- <strong>学习资料</strong>： - ControlNet高级用法：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Misdirection_XG/article/details/144926864">ComfyUI教程</a>。</p>
<hr>
<h4 id="day-6综合实战与优化"><strong>Day 6：综合实战与优化</strong></h4>
<p><strong>学习目标</strong>：结合所有技能生成复杂作品，优化细节。 -
<strong>实践步骤</strong>： 1.
设计完整场景（如“赛博朋克酒吧，女黑客坐在吧台，霓虹灯闪烁”）。 2.
分阶段调整：先用ControlNet固定构图，再通过提示词细化细节（服装、光影）。
3. 使用高清修复（Hires. fix）提升分辨率（2倍放大）。 -
<strong>检验成果</strong>：输出一张高完成度的综合作品（含角色、场景、风格）。</p>
<hr>
<h4 id="day-7扩展学习与效率提升"><strong>Day
7：扩展学习与效率提升</strong></h4>
<p><strong>学习目标</strong>：探索高级插件（如动态扩散、工作流优化）。 -
<strong>推荐方向</strong>： -
<strong>动态模型转换</strong>：生成连续动作帧（如转身、行走）。 -
<strong>批量生成</strong>：用XYZ脚本生成多组参数对比图。 -
<strong>效率工具</strong>：安装<code>Tiled Diffusion</code>插件减少显存占用。</p>
<hr>
<h3 id="学习资料汇总"><strong>学习资料汇总</strong></h3>
<table>
<colgroup>
<col style="width: 27%">
<col style="width: 45%">
<col style="width: 27%">
</colgroup>
<thead>
<tr>
<th>类型</th>
<th>资源链接</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>整合包</td>
<td><a target="_blank" rel="noopener" href="https://pan.quark.cn/s/2c832199b…">秋葉整合包下载</a></td>
<td>本地部署SD</td>
</tr>
<tr>
<td>提示词</td>
<td><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_59236602/article/details/144736778">AIGC提示词手册</a></td>
<td>风格与细节控制</td>
</tr>
<tr>
<td>模型库</td>
<td><a target="_blank" rel="noopener" href="https://civitai.com/">Civitai</a></td>
<td>下载大模型与LoRA</td>
</tr>
<tr>
<td>进阶教程</td>
<td><a target="_blank" rel="noopener" href="https://jalammar.github.io/illustrated-stable-diffusion/">ControlNet全解</a></td>
<td>精准控制画面</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="检验学习成果的标准"><strong>检验学习成果的标准</strong></h3>
<ul>
<li><strong>基础生成</strong>：能通过提示词生成无明显崩坏的图片。</li>
<li><strong>风格控制</strong>：同一主题可输出3种以上不同风格（如油画、像素风、水墨）。</li>
<li><strong>角色控制</strong>：生成与线稿或LoRA匹配的角色（误差&lt;10%）。</li>
<li><strong>场景与动作</strong>：构图符合预设，人物动作自然无畸形。</li>
</ul>
<p>按此路线实践，一周后可熟练运用AI绘画工具完成创作需求。遇到问题可随时查阅秋葉整合包的社区讨论（B站/CSDN），或私信我进一步解答！
🎨</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/19/AI%E7%BB%98%E7%94%BB%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E6%A6%82%E8%BF%B0/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xiaolinxiaozhu.github.io/2025/03/05/%E7%B1%BB%E9%93%B6%E6%B2%B3%E6%81%B6%E9%AD%94%E5%9F%8E%E6%B8%B8%E6%88%8F%E7%9A%84%E5%9C%B0%E5%9B%BE%E8%AE%BE%E8%AE%A1/">

    <span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="XLXZ">
    </span>

    <span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XLXZ's Blog">
      <meta itemprop="description" content="����ϲ�������仰:1.���Ŀ���ж�ᶨ?2.����ͽ���һ����">
    </span>

    <span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XLXZ's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/03/05/%E7%B1%BB%E9%93%B6%E6%B2%B3%E6%81%B6%E9%AD%94%E5%9F%8E%E6%B8%B8%E6%88%8F%E7%9A%84%E5%9C%B0%E5%9B%BE%E8%AE%BE%E8%AE%A1/" class="post-title-link" itemprop="url">类银河恶魔城游戏的地图设计</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-03-05 12:47:00 / 修改时间：12:47:24" itemprop="dateCreated datePublished" datetime="2025-03-05T12:47:00+08:00">2025-03-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>18</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 ≈</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a href="/tags/未完成/" rel="contents" data-pjax-state="">#
未完成</a> <br> <a href="/tags//" rel="contents" data-pjax-state="">#
</a> <br></p>
<h3 id="类银河恶魔城游戏的地图设计">类银河恶魔城游戏的地图设计</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/03/05/%E7%B1%BB%E9%93%B6%E6%B2%B3%E6%81%B6%E9%AD%94%E5%9F%8E%E6%B8%B8%E6%88%8F%E7%9A%84%E5%9C%B0%E5%9B%BE%E8%AE%BE%E8%AE%A1/#more" rel="contents">
                阅读全文 »
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">…</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    © 2023 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">XLXZ</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> &amp; <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>








  




  

  






<script src="/bundle.js"></script><script>false;
{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script></body></html>